---
const title = "Registro"
import Layout from "@/layouts/Layout.astro";
import NavBar from "@/components/NavBar.astro";
---
<Layout>
    <NavBar />
<html>
  <head>
    <title>Registro</title>
  </head>
  <body>
    <h1>Registro</h1>
    <form id="register-form">
      <input type="text" name="username" placeholder="Nombre de usuario" required />
      <input type="email" name="email" placeholder="Correo electr칩nico" required />
      <input type="password" name="password" placeholder="Contrase침a" required />
      <button type="submit">Registrarse</button>
    </form>

    <script>
      document.addEventListener("DOMContentLoaded", function () {
        const form = document.getElementById("register-form");

        if (!(form instanceof HTMLFormElement)) {
          console.error("No se encontr칩 un formulario v치lido.");
          return;
        }

        form.onsubmit = async function (event) {
          event.preventDefault();

          const formData = new FormData(form);
          const user = {
            username: formData.get("username"),
            email: formData.get("email"),
            password: formData.get("password"),
          };

          try {
            const response = await fetch("http://localhost:5000/api/auth/register", {
              method: "POST",
              headers: { "Content-Type": "application/json" },
              body: JSON.stringify(user),
            });

            const data = await response.json();
            alert(data.message || "Registro exitoso");
          } catch (error) {
            alert("Error en el registro");
          }
        };
      });
    </script>
  </body>
</html>
</Layout>
